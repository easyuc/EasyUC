Two Way Secure Message Communication
=====================================================================

The files in this directory express two way secure message
communication ([`SMC2.uc`](SMC2.uc)), which lets the clients of the
two parties securely exchange a pair of messages of two different
types: first one from the first to the second, followed by one from
the second to the first.

`SMC2.uc` is implemented using a forwarding functionality
[`Forwarding.uc`](Forwarding.uc), which lets the adversary observe and
delay message delivery, along with ordinary secure message
communication ([`SMC.uc`](SMC.uc)), which is in turn implemented using
forwarding and one-time pad encryption, using a key agreed using
Diffie-Hellman key exchange ([`KeyExchange.uc`](KeyExchange.uc)).

EasyCrypt style-cloning is used by the UC DSL so that `SMC2.uc` is
parameterized by Diffie-Hellman keys (a group) and exponents (a
commutative semigroup), along a generator key, `g`, exponentiation
raising a key to an exponent, and two types of plain texts for which
there are operators injecting them into keys. The two parties of
`KeyExchange` agree a shared key as `g ^ q2 ^ q1` and `g ^ q1 ^ q2`,
where `q1` and `q2` are random exponents generated by the two
parties. And if a plaintext has been injected into the group of keys
as `k`, it is then encrypted as `k ^^ (g ^ q2 ^ q1)`.  Then `k ^^ (g ^
q2 ^ q1) ^^ kinv (g ^ q1 ^ q2)` simplifies to `k`, which may be
projected back to the original text value.

There are three supporting EasyCrypt files. [`EPDPAux.ec`](EPDP.ec)
defines an encoding partial decoding pair (EPDP) needed by
`SMC2.uc`. [`KeyExp.ec`](KeyExp.ec) defines abstract types of
Diffie-Hellman keys and exponents, and is cloned by `KeyExchange.uc`.
And [`KeyExpText.ec`](KeyExpText.ec), defines keys, exponents and
plain texts.  `KeyExpText` clones `KeyExp`, and both `KeyExpText` and
`KeyExchange` are cloned by `SMC`. Finally `SMC2` clones `SMC` twice.

The adversarial model of `SMC2` is simply the one provided by the
forwarding functionalities, letting the adversarial observe and delay
all communications between parties.

The files of this case study are extensively commented. To learn about
the UC DSL, one should study the files in the order `Forwarding.uc`,
`KeyExp.ec`, `KeyExchange.uc`, `KeyExpText.ec`, `SMC.uc`, `EPDPAux.ec`
and `SMC2.uc`.

[testing.uci](testing.uci) is an interpretation script for
experimenting with the application of the real functionality of
`SMC2.uc` to completely real arguments.  This file is also extensively
commented, and much can be learned by trying variations on its
commands. It features experiments with both the real and ideal worlds,
where the latter consists of the ideal functionality for `SMC2` plus
the stack of simulators derived from recursively replacing real
arguments by ideal ones.

To see how EasyCrypt expressions are simplified during interpretation,
one can turn on debugging using the UC DSL Interpreter menu in the
menu bar, and then display the buffer `*trace*`. There is also an
interpretation script [`testing-idealish.uci`](testing-idealish.uci),
for experimenting with the application of the real functionality of
`SMC2.uc` to first the ideal functionality of `SMC.uc` and second to
the completely real functionality of `SMC.uc`.
